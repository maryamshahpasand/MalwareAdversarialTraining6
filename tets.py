import numpy as np
import sys
import psutil
import os
import csv


import load_data
import build_classifier
import GAN
import retrain_classifier
import matplotlib.pyplot as plt

hist = {}
hist['0.1'] = []
hist['0.2'] = []
hist['0.3'] = []
hist['0.4'] = []
hist['0.5'] = []
jist =[]
jisto =[]
with open('/home/maryam/Code/python/adversarial_training/torch_impl/adv-hist.csv', 'r', newline='') as outfile1:
    # f= outfile1.readline()
    # for l in f:
    #     jist.append(l)
    wr = csv.reader(outfile1, delimiter=',' , quoting=csv.QUOTE_NONE)
    for row in wr:
        jist.append([ float(i) for i in row ])
        # jisto = map(float , wr)
    outfile1.close()
j=0
# for por in [0.5 , 0.4 , 0.3 , 0.2 ,0.1]: #, 0.4 , 0.3 , 0.2 ,0.1  ]:
for key in hist:
    hist[key]= jist[j]
    j+=1


x = range(len(hist['0.4']))

y1 = hist['0.1']
y2 = hist['0.2']
y3 = hist['0.3']
y4 = hist['0.4']
y5 = hist['0.5']

plt.plot(x, y1, label='0.1')
plt.plot(x, y2, label='0.2')
plt.plot(x, y3, label='0.3')
plt.plot(x, y4, label='0.4')
plt.plot(x, y5, label='0.5')

plt.xlabel('Round')
# plt.ylabel('False Positive Rate')
plt.ylabel('Attack Success Rate')

plt.legend(loc=0)
plt.grid(True)
plt.tight_layout()
# plt.show()
plt.savefig('/home/maryam/Code/python/adversarial_training/torch_impl/ASR_hist.png')